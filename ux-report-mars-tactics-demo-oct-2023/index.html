<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>User Experience Report: Mars Tactics Demo (Steam NextFest 2023) - XS Tech Thoughts</title><meta name="description" content="An examination of UX in the October 2023 demo of strategy/tactics video game Mars Tactics."><meta name="robots" content="index, follow, noarchive"><meta name="generator" content="Publii Open-Source CMS for Static Site"><!-- Global site tag (gtag.js) - Google Analytics --><script type="gdpr-blocker/Analytics" async src="https://www.googletagmanager.com/gtag/js?id=G-EHLH28GQMY"></script><script type="gdpr-blocker/Analytics">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-EHLH28GQMY' , { 'anonymize_ip': true });
				  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EHLH28GQMY"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EHLH28GQMY');</script><link rel="stylesheet" href="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-black.css"><link rel="stylesheet" href="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-inline-color.css"><link rel="canonical" href="https://korgano.github.io/ux-report-mars-tactics-demo-oct-2023/"><link rel="alternate" type="application/atom+xml" href="https://korgano.github.io/feed.xml"><meta property="og:title" content="User Experience Report: Mars Tactics Demo (Steam NextFest 2023)"><meta property="og:image" content="https://korgano.github.io/media/posts/6/20231013082123_1.jpg"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="1080"><meta property="og:site_name" content="XS Tech Thoughts"><meta property="og:description" content="An examination of UX in the October 2023 demo of strategy/tactics video game Mars Tactics."><meta property="og:url" content="https://korgano.github.io//ux-report-mars-tactics-demo-oct-2023/"><meta property="og:type" content="article"><link rel="preload" href="https://korgano.github.io/assets/dynamic/fonts/robotoflex/robotoflex.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://korgano.github.io/assets/dynamic/fonts/robotoslab/robotoslab.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://korgano.github.io/assets/css/style.css?v=338ed96ce9bc0f6c72a02763a377a303"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://korgano.github.io/ux-report-mars-tactics-demo-oct-2023/"},"headline":"User Experience Report: Mars Tactics Demo (Steam NextFest 2023)","datePublished":"2023-10-10T15:05-04:00","dateModified":"2023-10-13T18:51-04:00","image":{"@type":"ImageObject","url":"https://korgano.github.io/media/posts/6/20231013082123_1.jpg","height":1080,"width":1920},"description":"An examination of UX in the October 2023 demo of strategy/tactics video game Mars Tactics.","author":{"@type":"Person","name":"Xavier Santana","url":"https://korgano.github.io/authors/xavier-santana/"},"publisher":{"@type":"Organization","name":"Xavier Santana"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template lines"><div class="container lines lines--right"><header class="header"><a href="https://korgano.github.io/" class="logo">XS Tech Thoughts</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu">Menu</button><ul class="navbar__menu"><li><a href="https://korgano.github.io/" title="Home" target="_self">Home</a></li><li><a href="https://korgano.github.io/tags/uxui-case-study/" title="UX/UI Case Studies" target="_blank">UX/UI Case Studies</a></li><li><a href="https://korgano.github.io/tags/cybersecurity-projects/" title="Cybersecurity Projects" target="_blank">Cybersecurity Projects</a></li><li><a href="https://korgano.github.io/tags/quick-thoughts/" title="Quick Thoughts" target="_self">Quick Thoughts</a></li><li><a href="https://korgano.github.io/about-me/" title="About Me" target="_blank">About Me</a></li></ul></nav></header><main class="main post"><article class="content"><header class="content__inner content__header"><h1 class="content__title">User Experience Report: Mars Tactics Demo (Steam NextFest 2023)</h1><div class="content__meta"><div class="content__meta__left"><a href="https://korgano.github.io/authors/xavier-santana/" class="invert content__author" rel="author" title="Xavier Santana">Xavier Santana</a></div><div class="content__meta__right"><time datetime="2023-10-10T15:05" class="content__date">October 10, 2023</time><div class="content__updated">Updated on <time datetime="2023-10-10T15:05" class="content__date">October 13, 2023</time></div></div></div></header><figure class="content__featured-image"><div class="content__featured-image__inner is-img-loading"><img src="https://korgano.github.io/media/posts/6/20231013082123_1.jpg" srcset="https://korgano.github.io/media/posts/6/responsive/20231013082123_1-xs.jpg 384w, https://korgano.github.io/media/posts/6/responsive/20231013082123_1-sm.jpg 600w, https://korgano.github.io/media/posts/6/responsive/20231013082123_1-md.jpg 768w, https://korgano.github.io/media/posts/6/responsive/20231013082123_1-lg.jpg 1200w, https://korgano.github.io/media/posts/6/responsive/20231013082123_1-xl.jpg 1600w" sizes="(min-width: 37.5em) 1600px, 80vw" loading="eager" height="1080" width="1920" alt="Mars Tactics Demo Start Sceen"></div></figure><div class="content__inner"><div class="content__entry"><figure><strong>Editor's Note: </strong>The body of this post was written prior to <a href="https://steamcommunity.com/app/1727760/discussions/0/7257046178088222946/" title="Mars Tactics - New patch deployed: 0.2.27" target="_blank" rel="noopener noreferrer">demo patch 0.2.27</a>, which changed certain gameplay and UX/UI functionality.</figure><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/SIs138qkotU" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Turn-based strategy/tactics games are some of the most interesting from a user experience point of view, because of how much they depend on the player's interactions with the user interface.</p><p>How long it takes to execute a task with a unit, whether that's actions (mouse movement, clicks, etc...) or time, multiplied by the number of units, determines the length of each turn. And as turn length increases, the longer a mission lasts, which increases the chances of wearing out the user.</p><p>But this isn't the only thing that affects the user experience. There's also the choices the developers make, and what might seem fine when tested by people who know how things are <strong>intended </strong>to work, might not be good when experienced by outsiders.</p><p>Mars Tactics might be one of those games.</p><p>The premise of Mars Tactics is pretty simple: We've colonized Mars, and corporate mismanagement/war crimes has led to an armed workers revolt. Players can control Corporate or Labor forces in tactical missions to achieve objectives that further strategic gameplay, such as recruiting new soldiers or obtaining new resources.</p><p>So, let's dive into the UX of the (at present) most recent Mars Tactics demo.</p><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1hciv6c9q187">Suppression's Still Good</a></li><li><a href="#mcetoc_1hciv6c9q188">The Dark Side of Suppression</a></li><li><a href="#mcetoc_1hciv6c9q189">Physics Gives...</a></li><li><a href="#mcetoc_1hciv6c9q18a">Physics Takes Away</a></li><li><a href="#mcetoc_1hciv6c9q18b">The AI Doesn't Have Handicaps</a></li><li><a href="#mcetoc_1hciv6c9q18c">Rescuing Prisoners Breaks the UI</a></li><li><a href="#mcetoc_1hciv6c9q18d">There's a Reason You Shouldn't Have 8+ Controllable Units</a></li><li><a href="#mcetoc_1hciv6c9q18e">The Evac Requirements are Insane</a></li></ul></div><h3 id="mcetoc_1hciv6c9q187">Suppression's Still Good</h3><p>Perhaps the single biggest mechanical innovation of Mars Tactics over the Firaxis XCOM games, which are the gold standard of comparison, is the suppression mechanic implementation.</p><p>In XCOM and several games it inspired, suppression is a dedicated ability that allows a unit to shoot at an enemy without hitting it, while reducing the enemy's aim (and possibly other abilities) by some amount. It's generally used when the player needs to capture an enemy alive, or when there's a low hit probability for a lethal attack, but you need to weaken a specific enemy somehow.</p><p>In Mars Tactics, suppression is not an ability. Instead, suppression is based on a meter associated with each unit. Each time you fire a gun at a unit, <strong>even if it does not hit</strong>, adds to this meter. Once this meter is filled, the unit is suppressed, which prevents it from attacking or moving. Suppression generally ends when the next turn starts, with the meter slowly depleting over the course of the next turns, allowing for multiple suppressions in a row.</p><p>The amount of suppression per attack is determined by the type of weapon. Fully automatic weapons have a higher chance to suppress, for example. Flashbang grenades also max out the suppression meter immediately.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/sUOsBL8ISPY" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Even better, you can have it apply when you just spray bullets in an arc!</p><h3 id="mcetoc_1hciv6c9q188">The Dark Side of Suppression</h3><p>Unfortunately, there's a number of design decisions that make this novel mechanic a detriment to the user experience.</p><p>The first is an unusual one - tying grenade effectiveness to suppression. To put it bluntly, unless you either exploit the game's physics (more on that later), using <strong>any </strong>grenade besides a flashbang or smoke grenade is useless. Units on both sides auto-scamper away (more on that later too), which means that tossing a grenade will usually result in <strong>zero </strong>damage to the enemy and one less grenade that you might be able to use later.</p><p>Now, this might not be a problem if/when the player has a Light Machinegun, which the demo's menu tells you about. A weapon with decent range and a high suppression factor would make grenades very usable. But when your squad of units <strong>does not </strong>have such a weapon, there are only two ways to make grenades effective:</p><ol><li>Toss a smoke/flashbang grenade at the enemies, <strong>then </strong>toss an explosive grenade at them.</li><li>Exploit the game's physics to get the grenade close enough to kill them without triggering the auto-scamper.</li></ol><p>And then there's how suppression ties into initiative, but first, let's look at something more positive.</p><h3 id="mcetoc_1hciv6c9q189">Physics Gives...</h3><p>There's some fun things you can do with the physics in Mars Tactics, which do produce positive UX for the player:</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/z7wGuDD2rrE" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/r4WFfoVLR7M" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>It's difficult to put into words how <strong>satisfying </strong>these kinds of interactions are. Perhaps the best analogy would be the game Baldur's Gate 3, where much of the game's appeal comes from the developers giving a wide variety of ways to accomplish any task.</p><p>Being able to do just about anything and discover that it's a viable solution is a standout feature in an age when games are getting more restrictive with what you can do. But it's not all sunshine and roses...</p><h3 id="mcetoc_1hciv6c9q18a">Physics Takes Away</h3><p>So let's look at that second grenade video again:</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/r4WFfoVLR7M" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>You might be wondering how I knew the grenade would roll like that on top of the rock.</p><p>I didn't.</p><p>I just took a chance, lobbed it over there, and got super lucky it rolled. Even with the grenade tooltip telling me that grenades can bounce (and roll, apparently), I had no way of knowing this outcome was possible. And in a tactical/strategy game, that's not great.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/jVfHGllck3s" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>One of big problems with Mars Tactics is that the focus on physics interactions makes gameplay unpredictable. For example, the clip above is one of <strong>several </strong>times where I wasted ammunition shooting into a wall or physical object in the line of fire. This made even worse by the fact that you have to <strong>manually </strong>maneuver around your units own cover by holding Left CRTL, which makes things even more awkward.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/OBUsTGWvyuc" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Oh, and the game physics means that you can kill your own guys while trying shoot around them, which is not great.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/4vtdykH7aRo" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Also, smoke grenades can somehow cause explosions that kill people, even though they are not actually explosives and don't explode in real life.</p><p>A lot of what makes strategy/tactics games fun is figuring how to respond to certain scenarios/challenges presented by the game. Mars Tactics' combination of physics and unit control micromanagement/precision basically makes that impossible for anyone playing the demo. Everything is just too chaotic and variable to learn from.</p><p>But wait, it gets worse!</p><h3 id="mcetoc_1hciv6c9q18b">The AI Doesn't Have Handicaps</h3><p>In most video games, including the Firaxis XCOM games, the AI is given massive handicaps so that players don't get curbstomped immediately.</p><p>Mars Tactics' demos <strong>do NOT </strong>do this.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/4vtdykH7aRo" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>The fundamental problem with Mars Tactics is multilayered:</p><ol><li>The AI perfectly understands how things are intended to work, while the player may not.</li><li>The AI doesn't care about conserving items for use later, like the player does.</li><li>The AI doesn't have barriers to execution in the form of manually maneuvering around objects.</li><li>The AI units are generally on the defensive in the demo missions, giving them stronger starting tactical positions.</li></ol><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/N4jFu7GC15E" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>What this results in is a miserable user experience, as the player encounters a near vertical difficulty curve. It is basically impossible to be as effective as the AI controlled enemy units <strong>without </strong>taking 50/50 chances on exploiting the game physics.</p><p>I <strong>literally </strong>only managed to achieve the objective of the mission because I managed to do those two distance grenade kills. Those weren't feats of skill or execution - they were pure <strong>luck </strong>that I had units with explosives and put them in the right spots to get those kills.</p><p>Unsurprisingly, a lot of feedback on the current demo is negative, indicating to me that a lot of people were <strong>not </strong>lucky, and found themselves overwhelmed by the enemy AI's mastery of the game systems.</p><h3 id="mcetoc_1hciv6c9q18c">Rescuing Prisoners Breaks the UI</h3><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/8eiG3atGNvg" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Mars Tactics has a number of UI issues. One of them is that the unit info card above the units on the game map has really limited scaling. This is a problem, because playing this game at anything less than fully zoomed out (which isn't a setting in the menu yet) makes situational awareness impossible.</p><p>Having individual cards on the left side of the screen is a more subjective issue. It seems to be a popular trend for newer turn-based tactics/strategy games, but I find it clutters the screen. It'd be interesting to see some UX research into whether that provides value for people.</p><p>However, what is indisputable is that there's an upper limit on how many cards you should have, and it's <strong>way </strong>less than the total number of prisoners you could liberate in the mission. (I am genuinely unsure if this was a bug or a deliberate option for the demo.)</p><p>As seen above, I wound up liberating several dozen groups of four prisoners, which filled the left side of my screen with a non-scrolling list of character info cards. This made it borderline impossible to select specific units without actually hovering over them and mouse clicking on them.</p><h3 id="mcetoc_1hciv6c9q18d">8+ Controllable Units is Too Much</h3><p>I didn't clip this because it was boring, but after liberating dozens of prisoners, I spent no less than <strong>10 minutes </strong>moving them around. Thankfully, due to the way the map was designed, I was able to get almost all of them into the evac zone on the map's border, but this highlights another major UX problem.</p><p>In a previous case study, I examined the user interface (UI) of SD Gundam G Generation, another example of a turn-based strategy/tactics game. Part of the UI redesign process involved assessing the efficiency of the design, which led to the discovery of how heavily cumulative actions per turn contributes to turn length. The amount of actions rapidly compounds as unit count increases, which in turn leads to longer turns.</p><p>So, as you can imagine, having to control dozens of units <strong>individually </strong>leads to drawn out turns. </p><p>This leads to the question "Why control the prisoners individually?" And based on the modal that appeared, I <strong>think </strong>the idea was that the prisoners would be able to pick up gear from dead enemy units killed by the train. The problem is that it's functionally useless <strong>unless </strong>you happen to kill some enemies by the train.</p><p>So, in that case, why not have the group of four prisoners be controlled as a single unit? Either standing side by side or in a square, they would be much easier to manage.</p><h3 id="mcetoc_1hciv6c9q18e">The Evac Requirements are Insane</h3><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/mR4d3uX0my0" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>One good game design decision in Mars Tactics is having the edges of the maps serve as evacuation zones. This gives the player fantastic options for withdrawing their soldiers, and removes the hurdle of bad evac zone placement.</p><p>However, what is <strong>not </strong>great user experience is having to wait three turns before actually being able to evacuate a unit.</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/E7ZQHR8IlQ8" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><p>Not only did it mean that some of the people I freed got shot, but the evac limitations actually<strong> incentivized</strong> me to create a huge group of meat shields in the first place!</p><p>This is because I read the tooltip about the 3 turn requirement, realized most of my squad was a fair distance from the evac zone, and knew enemy reinforcements were coming. So I needed a <strong>lot </strong>of targets to ensure that A) some amount of prisoners would survive, and B) buy me enough time to get the squad moved towards the evac zone.</p><p>That plan fell apart the nanosecond an enemy soldier tossed a grenade and forced two of my soldiers <strong>away </strong>from the evac zone, which forced me to give up saving one of them (as seen above). Then I had one last soldier to evacuate, and that did not end well:</p><figure class="post__video"><iframe loading="lazy" width="560" height="314" src="https://www.youtube-nocookie.com/embed/sd8xRUfqQzo" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure><h3>Possible Ways to Improve the UX</h3><p>So, having gone over many of the UX issues that this game has, it's time to make some suggestions.</p><ul><li>Reduce AI aggression, and possibly vision radius, to increase player unit survival.</li><li>Make the LMG one of the weapons given to player characters in the demo.</li><li>Reduce required time in the evac zone from 3 turns to 1.</li><li>Reduce or eliminate scamper after explosive grenades land.</li><li>Have groups of 4 prisoners be controlled as a single unit.</li><li>Have step out either use a toggle instead of a hold, or automatically incorporate it into the shooting process.</li></ul><p>These are the most obvious UX changes that could possibly mitigate the difficulty issues. Whether or not these would actually solve most of the problems people have with Mars Tactics is an open question.</p><p>Right now, the demos suggest that the game might be less than the intended sum of its parts. But perhaps one change might be all the difference between the perception of unfun brutality, and a deep and engaging strategy/tactics game.</p><h3>Quick Notes on Patch 0.2.27</h3><p>While I was writing this article, the demo was patched. So, instead of posting without seeing if the patch addressed any of my complaints, I decided to fire it up for a quick session on the second level. (Having played possibly three hours of the first level, I have no interest in returning to it at present.)</p><p>The stated changes are as follows:</p><blockquote><p>Bugs<br>🐛 Fixed bug that crashed the game when booting up for the first time.<br>🐛 Fixed bug where Spaceport mission said you lost even though you all killed enemies.<br>🐛 Fixed bug where your units didn't recover health between missions.<br><br>Balance<br>🧠When scrambling from a flying grenade, units now estimate the grenade trajectory when planning their scramble route.<br>🎯When a hunkered unit becomes flanked, they lose their defense bonus. Pretty huge balance change!!!<br>🧀Turned off ability to modify grenade throwing arc as it was buggy. This feature will come back after I fix it properly.<br><br>QoL<br>👻 Enemies no longer teleport when running through obscured areas.<br>✨ Various UI and UX improvements</p></blockquote><p>It is unfortunate that there are no specifics on the UX/UI changes, but one that I think I spotted was a color change for the dashing movement radius from green to a light blue.</p><p>One thing that I realized after reading the patch notes is that <strong>I don't when units are flanked</strong>. In XCOM, the icon representing their amount of cover turns yellow/gold to show flanked status. In Mars Tactics, I don't have that information, so I can't strategize around it.</p><p>I couldn't tell much of a difference between pre- and post-patch scrambling from grenades, but that was complicated by the fact that one of my units actually had the ability to throw grenades back (which is awesome). I did run into a possible bug where you can throw an unprimed grenade, have another unit pick it up the following turn, then use the command to prime and throw said grenade, only to have it land and <strong>not </strong>detonate.</p><p>One odd thing I discovered playing the second level is that the objective might be bugged. You're supposed to get your squad onto a jet in the middle of the map and use it to evac. What I managed to do was get three squad members aboard, then it took off for some reason before I could get the rest on. (You should've seen my reaction to that.) I think it's a bug because there's a big button on the top third of the screen that says "Escape" and has the number of people on the plane on it, which isn't dismissed when the plane leaves.</p><figure class="post__image post__image--full"><img loading="lazy" src="https://korgano.github.io/media/posts/6/20231013174212_1.jpg" alt="" width="1920" height="1080" sizes="(min-width: 37.5em) 1600px, 80vw" srcset="https://korgano.github.io/media/posts/6/responsive/20231013174212_1-xs.jpg 384w, https://korgano.github.io/media/posts/6/responsive/20231013174212_1-sm.jpg 600w, https://korgano.github.io/media/posts/6/responsive/20231013174212_1-md.jpg 768w, https://korgano.github.io/media/posts/6/responsive/20231013174212_1-lg.jpg 1200w, https://korgano.github.io/media/posts/6/responsive/20231013174212_1-xl.jpg 1600w"></figure><p>Most baffling is the Escape Battle command, which might be a response to the criticisms of the 3 turn to escape limit.</p><p>What this amounts to is spending the equivalent of two turns <strong>at best </strong>trying to escape by hammering the button. This assumes that the player's units are <strong>not </strong>being shot at, in which case, fulfilling this condition will result in at least <strong>three </strong>turns, because the player will spend at least one unit action moving the unit.</p><p>I'm not sure what the point of all these roadblocks to simply evacuating units are intended to do. By the time the player gets one or all of their units to the edge of the map (where the evac zones are), they're probably mentally exhausted by the current mission and ready to move on. Forcing the player to persist in the level, possibly while under attack by enemy forces that out number theirs, seems like a recipe to guarantee "cheap" deaths.</p><p>In a game where your units permanently die, there is nothing worse than losing characters to bad mechanics. Making bad tactical decisions or the AI being better is one thing - you can restart the mission or abuse saves to get around that. But bad mechanics are inescapable, because they're how the game <strong>works</strong>.</p><p>It's one thing in this demo, where you can get fresh soldiers with no issues. It's another when you have experienced soldiers you want to carry forward... only to have them get killed because they were stuck in the evac zone and got hit by a lucky shot. That's a decent investment of in-game resources gone, for no other result than an angry or sad player.</p><p>The Firaxis XCOM games make evacuation a free action, one you can do even when the units expend all their standard action points. There's a reason for that. At the end of a mission, the player is <strong>done</strong>. Let them go in peace, preferably with a button to evac everyone in the evac zone at once.</p></div><footer class="content__footer"><div class="content__tag-share"><div class="content__tag"><h3 class="content__tag__title">Posted in</h3><ul class="content__tag__list"><li><a href="https://korgano.github.io/tags/quick-thoughts/">Quick Thoughts</a></li><li><a href="https://korgano.github.io/tags/ux/">UX</a></li><li><a href="https://korgano.github.io/tags/uxui/">UX/UI</a></li><li><a href="https://korgano.github.io/tags/video-games/">Video Games</a></li></ul></div><div class="content__share"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fkorgano.github.io%2Fux-report-mars-tactics-demo-oct-2023%2F" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://korgano.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div></div></footer></div></article><div class="content__related"><h3 class="content__related__title">Related posts</h3><div class="l-grid l-grid--2"><article class="c-card"><div class="c-card__wrapper"><figure class="c-card__image is-img-loading"><img src="https://korgano.github.io/media/posts/4/vadim-sherbakov-RcdV8rnXSeE-unsplash.jpg" srcset="https://korgano.github.io/media/posts/4/responsive/vadim-sherbakov-RcdV8rnXSeE-unsplash-xs.jpg 384w, https://korgano.github.io/media/posts/4/responsive/vadim-sherbakov-RcdV8rnXSeE-unsplash-sm.jpg 600w, https://korgano.github.io/media/posts/4/responsive/vadim-sherbakov-RcdV8rnXSeE-unsplash-md.jpg 768w, https://korgano.github.io/media/posts/4/responsive/vadim-sherbakov-RcdV8rnXSeE-unsplash-lg.jpg 1200w" sizes="(min-width: 37.5em) 80vw, 50vw" loading="lazy" height="3648" width="5472" alt="Two flat screen monitor turned on near organizer rack inside the room."></figure><div class="c-card__content"><header><h2 class="c-card__title"><a href="https://korgano.github.io/user-experience-report-publii-day-1/" class="invert">User Experience Report: Publii, Day 1</a></h2></header><footer class="c-card__meta"><a href="https://korgano.github.io/tags/quick-thoughts/" class="c-card__tag">Quick Thoughts</a></footer></div></div></article></div></div></main><footer class="footer"><div class="footer__left"><div class="footer__copy">Copyright Xavier Santana, 2023-2024. Powered by Publii.</div></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://korgano.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script defer="defer" src="https://korgano.github.io/assets/js/scripts.min.js?v=9c5ab7a87221183f149a42b3cceb7956"></script><script>function publiiDetectLoadedImages () {
         var images = document.querySelectorAll('img[loading]:not(.is-loaded)');
         for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
               images[i].classList.add('is-loaded');
               images[i].parentNode.classList.remove('is-img-loading');
            } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
                  this.parentNode.classList.remove('is-img-loading');
               }, false);
            }
         }
      }
      publiiDetectLoadedImages();</script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-inline-color.min.js"></script><script defer="defer" src="https://korgano.github.io/media/plugins/syntaxHighlighter/prism-show-invisibles.min.js"></script><!-- Start main cookie container --><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><!-- Start Banner --><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="https://korgano.github.io/privacy-policy/">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><!-- End of Banner --><!-- Badge --> <button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button><!-- End of Badge --></div><!-- End of main cookie container --><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        initialLsState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                    'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                    'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                    'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                    'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                    'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                    'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                });  
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                        'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                        'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                        'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                        'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                        'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                        'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                    }));
                }
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            cbConfig.initialLsState = currentConfig.split(',');

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                    'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                    'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                    'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                    'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                    'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                    'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                });
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                        'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                        'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                        'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                        'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                        'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                        'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                    }));
                }
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function getDefaultConsentState (currentConfig, consentGroup) {
        let configGroups = currentConfig.split(',');

        for (let i = 0; i < configGroups.length; i++) {
            let groupName = configGroups[i];
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === groupName);

            if (group && group[consentGroup]) {
                return 'granted';
            }
        }  
        
        if (window.publiiCBGCM.defaultState[consentGroup]) {
            return 'granted'; 
        }
        
        return 'denied';
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }

        if (window.publiiCBGCM && cbConfig.initialLsState.indexOf(allowedGroup) === -1) {
            let consentResult = {};
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === allowedGroup);

            if (group) {
                let foundSomeConsents = false;

                Object.keys(group).forEach(key => {
                    if (key !== 'cookieGroup' && group[key] === true) {
                        consentResult[key] = 'granted';
                        foundSomeConsents = true;
                    }
                });

                if (foundSomeConsents) {
                    gtag('consent', 'update', consentResult);   

                    if (cbConfig.debugMode) {
                        console.log('🍪 GCMv2 UPDATE: ' + JSON.stringify(consentResult));
                    }
                }
            }
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupToCheck !== '' && groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>